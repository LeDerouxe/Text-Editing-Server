version: '3.8'

services:
  docs-server:
    build: .
    ports:
      - "${DOCS_PORT}:5000"
    volumes:
      - ./data:/app/data
    environment:
      - NODE_ENV=${NODE_ENV}
    command: node docs-server/server.js

  proxy-server:
    build: .
    ports:
      - "${PROXY_PORT}:4000"
    volumes:
      - ./data:/app/data  # share logs
    environment:
      - NODE_ENV=${NODE_ENV}
      - DOCS_SERVER=http://docs-server:5000  # internal network
    depends_on:
      - docs-server
    command: node proxy-server/proxy.js
